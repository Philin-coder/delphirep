unit Un_grupp;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ComCtrls, StdCtrls, Grids, DBGrids, ExtCtrls, ADODB,DB, DBCtrls;

type
  TFrm_grupp = class(TForm)
    SpecPage: TPageControl;
    SelTab: TTabSheet;
    InsTab: TTabSheet;
    UpdTab: TTabSheet;
    delTab: TTabSheet;
    SpecgroupBox: TGroupBox;
    SpecbtnBox: TGroupBox;
    SpecDataBox: TGroupBox;
    SpecSelGrid: TDBGrid;
    SpecSelBtn: TButton;
    SpecCondBox: TGroupBox;
    Spec_condEdit: TLabeledEdit;
    Spec_fnd_edit: TLabeledEdit;
    Spec_groupradio: TRadioButton;
    SpecResetRadio: TRadioButton;
    spec_inpBox: TGroupBox;
    spec_inp: TLabeledEdit;
    Spec_ins_btn_Box: TGroupBox;
    Spec_insBtn: TButton;
    SpecDataInsBox: TGroupBox;
    Spec_insGrd: TDBGrid;
    Spec_upd_inp_Box: TGroupBox;
    spec_upd_spec_inp: TLabeledEdit;
    Speclbl: TStaticText;
    SpecUpdDBL: TDBLookupComboBox;
    Spec_upd_btn_Box: TGroupBox;
    Spec_upd_Btn: TButton;
    Spec_upd_dataBox: TGroupBox;
    SpecUpddataGrd: TDBGrid;
    delspedatacBox: TGroupBox;
    delspeclbl: TStaticText;
    delSpecDBL: TDBLookupComboBox;
    dlspecbtnBox: TGroupBox;
    delspecBtn: TButton;
    delspecdataBox: TGroupBox;
    delspecGrd: TDBGrid;
    procedure FormActivate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Frm_grupp: TFrm_grupp;

implementation

uses Un_dm, Un_main, Un_func;

{$R *.dfm}

procedure TFrm_grupp.FormActivate(Sender: TObject);
begin
dm.GruppQuery.Open;
end;

procedure TFrm_grupp.FormClose(Sender: TObject; var Action: TCloseAction);
var
  q:Integer;
begin
  SaveFormState(Self);
 with dm do
 begin
    for q := 0 to ComponentCount - 1 do
 begin
    if(Components[q] is TADOQuery)  then
   begin
      (Components[q] as TADOQuery).Close;
   end;
   end;
   end;
   end;

end.
