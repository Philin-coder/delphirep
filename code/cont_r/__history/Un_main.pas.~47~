unit Un_main;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs,dateUtils, StdCtrls, Buttons, ExtCtrls, ComCtrls, Grids, DBGrids, ADODB,
  Menus,jpeg;

type
  TFrm_main = class(TForm)
    ItemMenu: TMainMenu;
    spec_item: TMenuItem;
    mainImage: TImage;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCreate(Sender: TObject);
    procedure spec_itemClick(Sender: TObject);

 private
    { Private declarations }
  public
    { Public declarations }


  end;

var
  Frm_main: TFrm_main;

implementation

uses Un_func, Un_dm, Un_spec;

{$R *.dfm}
// UpdateFormProperties('Frm_main', 'Главная форма', clBtnFace, 1024, 768);
// var
// ins_spec:TADOStoredProc;
//begin
//ins_spec:=TADOStoredProc.Create(self);
//with ins_spec do
//begin
//Connection:=DM.Connection;
//ProcedureName:='ins_spec';
//Parameters.Add;
//Parameters.Items[0].Name:='spec_maim';
//Parameters.ParamByName('spec_maim').Value:=LabeledEdit1.Text;
//ExecProc;
//Destroy;
//end;
//dm.testQuery.Close;
//dm.testQuery.Open;


procedure TFrm_main.FormClose(Sender: TObject; var Action: TCloseAction);
begin
 SaveFormState(Self);
 Action := caFree;
 mainImage.Picture:=nil;

end;

procedure TFrm_main.FormCreate(Sender: TObject);
begin
With Frm_main do
begin
Width:=1024;
Height:=768;
Position:=poScreenCenter;
end;
LoadFormState(Self);
With mainImage do
begin
  Stretch:=True;
  Picture.LoadFromFile('1.jpg');
  AutoSize:=True;
end;
end;

procedure TFrm_main.spec_itemClick(Sender: TObject);
begin
try
UpdateFormProperties('frm_spec', 'Форма работы со специальностью',clBtnFace, 1024, 768);
Frm_spec.ShowModal;
except
Frm_spec.Free;
raise;
end;

end;

end.


